<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Roasting Foto</title>
    <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"
    />
    <link rel="stylesheet" href="styles.css"/>
</head>
<body class="min-h-screen bg-slate-100">
<main class="container">
    <h1 class="text-xl text-center font-bold" align="center">Roasting Foto</h1>

    <p align="center">
        <a href="https://github.com/NFRamz"><img src="https://readme-typing-svg.herokuapp.com?lines=Teks+dibuat+menggunakan+AI;jadi+jangan+baper+yaa...ðŸ˜Š;&center=true&width=500&height=50"></a>
    </p>


    <form enctype="multipart/form-data">
        <label for="photo">Pilih gambar yang mau di roasting</label>
        <input
                type="file"
                accept="image/jpeg, image/jpg, image/png, image/webm"
                placeholder="Pilih gambar"
                id="photo"
                required
        />


        <!-- bUTTON ROAST -->
        <div class="container turnstile"></div>
        <button class="roast_button">
            Roasting Foto
            <div class="star-1">
                <svg
                        xmlns="http://www.w3.org/2000/svg"
                        xml:space="preserve"
                        version="1.1"
                        style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
                        viewBox="0 0 784.11 815.53"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                >
      <defs></defs>
                    <g id="Layer_x0020_1">
        <metadata id="CorelCorpID_0Corel-Layer"></metadata>
                        <path
                                class="fil0"
                                d="M392.05 0c-20.9,210.08 -184.06,378.41 -392.05,407.78 207.96,29.37 371.12,197.68 392.05,407.74 20.93,-210.06 184.09,-378.37 392.05,-407.74 -207.98,-29.38 -371.16,-197.69 -392.06,-407.78z"
                        ></path>
      </g>
    </svg>
            </div>
            <div class="star-2">
                <svg
                        xmlns="http://www.w3.org/2000/svg"
                        xml:space="preserve"
                        version="1.1"
                        style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
                        viewBox="0 0 784.11 815.53"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                >
      <defs></defs>
                    <g id="Layer_x0020_1">
        <metadata id="CorelCorpID_0Corel-Layer"></metadata>
                        <path
                                class="fil0"
                                d="M392.05 0c-20.9,210.08 -184.06,378.41 -392.05,407.78 207.96,29.37 371.12,197.68 392.05,407.74 20.93,-210.06 184.09,-378.37 392.05,-407.74 -207.98,-29.38 -371.16,-197.69 -392.06,-407.78z"
                        ></path>
      </g>
    </svg>
            </div>
            <div class="star-3">
                <svg
                        xmlns="http://www.w3.org/2000/svg"
                        xml:space="preserve"
                        version="1.1"
                        style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
                        viewBox="0 0 784.11 815.53"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                >
      <defs></defs>
                    <g id="Layer_x0020_1">
        <metadata id="CorelCorpID_0Corel-Layer"></metadata>
                        <path
                                class="fil0"
                                d="M392.05 0c-20.9,210.08 -184.06,378.41 -392.05,407.78 207.96,29.37 371.12,197.68 392.05,407.74 20.93,-210.06 184.09,-378.37 392.05,-407.74 -207.98,-29.38 -371.16,-197.69 -392.06,-407.78z"
                        ></path>
      </g>
    </svg>
            </div>
            <div class="star-4">
                <svg
                        xmlns="http://www.w3.org/2000/svg"
                        xml:space="preserve"
                        version="1.1"
                        style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
                        viewBox="0 0 784.11 815.53"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                >
      <defs></defs>
                    <g id="Layer_x0020_1">
        <metadata id="CorelCorpID_0Corel-Layer"></metadata>
                        <path
                                class="fil0"
                                d="M392.05 0c-20.9,210.08 -184.06,378.41 -392.05,407.78 207.96,29.37 371.12,197.68 392.05,407.74 20.93,-210.06 184.09,-378.37 392.05,-407.74 -207.98,-29.38 -371.16,-197.69 -392.06,-407.78z"
                        ></path>
      </g>
    </svg>
            </div>
            <div class="star-5">
                <svg
                        xmlns="http://www.w3.org/2000/svg"
                        xml:space="preserve"
                        version="1.1"
                        style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
                        viewBox="0 0 784.11 815.53"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                >
      <defs></defs>
                    <g id="Layer_x0020_1">
        <metadata id="CorelCorpID_0Corel-Layer"></metadata>
                        <path
                                class="fil0"
                                d="M392.05 0c-20.9,210.08 -184.06,378.41 -392.05,407.78 207.96,29.37 371.12,197.68 392.05,407.74 20.93,-210.06 184.09,-378.37 392.05,-407.74 -207.98,-29.38 -371.16,-197.69 -392.06,-407.78z"
                        ></path>
      </g>
    </svg>
            </div>
            <div class="star-6">
                <svg
                        xmlns="http://www.w3.org/2000/svg"
                        xml:space="preserve"
                        version="1.1"
                        style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd"
                        viewBox="0 0 784.11 815.53"
                        xmlns:xlink="http://www.w3.org/1999/xlink"
                >
      <defs></defs>
                    <g id="Layer_x0020_1">
        <metadata id="CorelCorpID_0Corel-Layer"></metadata>
                        <path
                                class="fil0"
                                d="M392.05 0c-20.9,210.08 -184.06,378.41 -392.05,407.78 207.96,29.37 371.12,197.68 392.05,407.74 20.93,-210.06 184.09,-378.37 392.05,-407.74 -207.98,-29.38 -371.16,-197.69 -392.06,-407.78z"
                        ></path>
      </g>
    </svg>
            </div>
        </button>

    </form>

    <div aria-busy="true" id="loading" style="opacity: 0; margin-block: 32px">
        Sabar lagi mikir...
    </div>

    <img
            id="preview"
            src=""
            alt="Foto Terkait"
            style="opacity: 0; max-width: 350px; height: 0"
    />

    <p id="roast" style="margin-block: 32px"></p>
</main>

<hr />

<footer class="container">

    <p>Modified NF_Ramz 11/Agustus/2024 | 22:23</p>
    <div class="btn-container">
        <div class="btn-wrapper">
            <button class="btn">
                <a target="_blank" href="https://instagram.com/nf_ramz">
                    Instagram
                </a>
            </button>
        </div>
        <div class="btn-wrapper">
            <button class="btn">
                <a target="_blank" href="https://github.com/NFRamz">
                    Github
                </a>
            </button>
        </div>
    </div>
    <br>Build With:</br>
    <a href="https://github.com/search?q=user%3Azmcx16&type=Repositories">
        <img src="https://img.shields.io/badge/-HTML-E34F26?style=flat&logo=html5&logoColor=white" alt="HTML Badge">
    </a>
    <a href="https://github.com/search?q=user%3Azmcx16&type=Repositories">
        <img src="https://img.shields.io/badge/-CSS-1572B6?style=flat&logo=css3&logoColor=white" alt="CSS Badge">
    </a>
    <a href="https://github.com/search?q=user%3Azmcx16&type=Repositories">
        <img src="https://img.shields.io/badge/-JavaScript-F7DF1E?style=flat&logo=javascript&logoColor=black" alt="JavaScript Badge">
    </a>
    <a href="https://github.com/search?q=user%3Azmcx16&type=Repositories">
        <img src="https://img.shields.io/badge/-Node.js-339933?style=flat&logo=node.js&logoColor=white" alt="Node.js Badge">
    </a>
    
</footer>

<script
        src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onloadTurnstileCallback"
        defer
></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
    const form = document.querySelector("form"), button = document.querySelector('form button');
    const photo = document.querySelector("#photo");
    const roast = document.querySelector("#roast");
    const loading = document.querySelector("#loading");
    const preview = document.querySelector("#preview");

    let cfttoken;

    photo.onchange = (evt) => {
        const [file] = photo.files;
        if (file) {
            preview.src = URL.createObjectURL(file);
            turnstile.reset('.turnstile')
        }
    };

    form.onsubmit = (e) => {
        e.preventDefault();
        roast.innerHTML = "";
        button.disabled = true

        if (!cfttoken) {
            loading.style.opacity = 0;
            roast.innerHTML =
                "Chaptchanya dicentang dulu yaa, dan reload ulang webnya.";
            return;
        }

        loading.style.opacity = 1;

        const data = new FormData();
        data.append("cf-turnstile-response", cfttoken);
        data.append("file", photo.files[0]);

        fetch("/upload", {
            method: "POST",
            body: data,
        })
            .then((response) => response.json())
            .then((data) => {
                if (data.ok) {
                    preview.style.opacity = 1;
                    preview.style.height = "100%";
                    loading.style.opacity = 0;
                    form.reset();
                    roast.innerHTML = marked.parse(data.text);
                    turnstile.reset(".turnstile");
                } else if (data.statusCode == 429) {
                    preview.style.opacity = 1;
                    preview.style.height = "100%";
                    loading.style.opacity = 0;
                    form.reset();
                    preview.src = '';
                    roast.innerHTML = `Traffic lagi rame, sabar sebentar pls ðŸ˜­ðŸ˜­<br><small>${data.message}</small>`;
                }
                else {
                    loading.style.opacity = 0;
                    roast.innerHTML =
                        "Roastingan terlalu brutal sampe kena sensor ðŸ”¥ðŸ”¥ðŸ’€ðŸ’€ðŸ¤£ðŸ¤£ðŸ¤£\nKlik Roast buat coba lagi";
                }
                button.disabled = false
            })
    };

    window.onloadTurnstileCallback = function () {
        fetch("/cfs", {
            method: "put",
        })
            .then((data) => data.text())
            .then((k) => {
                turnstile.render(".turnstile", {
                    sitekey: atob(k),
                    callback: function (token) {
                        cfttoken = token;
                    },
                });
            });
    };
</script>
<script>
  window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
</script>
<script defer src="/_vercel/insights/script.js"></script>
</body>
</html>
